<?xml version="1.0" encoding="utf-8" ?>
<Patch>
	<Operation Class="XmlExtensions.ForEach">
		<xpath>/Defs/ThingDef[@ParentName="MakeStoneBlocksBase"]</xpath>
		<storeIn>def</storeIn>
		<apply>
			<Operation Class="XmlExtensions.CreateVariable">
				<storeIn>inputCount</storeIn>
				<!-- This is potentially brittle, but the alternative would be to check if the
					 filtered thingdef is a stone chunk, which would be extremely performance-intensive. -->
				<value>{def}/ingredients/li[1]/count</value>
				<fromXml>true</fromXml>
				<defaultValue>1</defaultValue>
				<value2>3</value2>
				<fromXml2>false</fromXml>
				<operation>*</operation>
			</Operation>
			<Operation Class="XmlExtensions.CreateVariable">
				<storeIn>outputCount</storeIn>
				<!-- see above -->
				<value>{def}/products/*[1]/text()</value>
				<fromXml>true</fromXml>
				<defaultValue>20</defaultValue>
				<value2>3</value2>
				<fromXml2>false</fromXml2>
				<operation>*</operation>
			<Operation Class="XmlExtensions.PatchOperationSafeCopy">
				
	</Operation>
	<Operation Class="XmlExtensions.CreateDocument">
		<docName>D9SBP_temp_Stonecutting</docName>
		<xpath>/Defs/ThingDef[@ParentName="MakeStoneBlocksBase"]</xpath>
	<Operation>
	<Operation Class="XmlExtensions.ForEach">
		<xpath>/D9SBP_temp_Stonecutting/ThingDef[defName!=Make_StoneBlocksAny]</xpath>
		<storeIn>def</storeIn>
		<apply>
			<Operation Class="PatchOperationReplace">
				
			</Operation>
			<!-- multiply output count by 3 -->
			<Operation Class="XmlExtensions.CreateVariable">
				<storeIn>outputCount</storeIn>
				<value>{def}/products/*[1]</value>
				<fromXml>true</fromXml>
				<defaultValue>20</defaultValue>
				<value2>3</value2>
				<fromXml>false</fromXml>
				<operation>*</operation>
				<apply>
					<Operation Class="XmlExtensions.PatchOperationReplace">
						<xpath>{def}/products/*[1]/text()</xpath>
						<value>{outputCount}</value>
					</Operation>
				</apply>
			</Operation>
		</apply>
	</Operation>
</Patch>